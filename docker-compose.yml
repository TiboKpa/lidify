services:
  lidify:
    # Important : "build: ." dit à Portainer d'utiliser le Dockerfile du dépôt
    build: . 
    container_name: lidify
    restart: unless-stopped
    ports:
      - "10083:3030"
    volumes:
      # Adaptez selon le chemin SUR LE SERVEUR, pas dans le git
      - /opt/lidify/music:/music 
      - lidify_data:/data
    environment:
      - TZ=Europe/Paris
      # Les valeurs sont définies dans Portainer (section Environment variables)
      - SESSION_SECRET=${SESSION_SECRET}
      - SETTINGS_ENCRYPTION_KEY=${SETTINGS_ENCRYPTION_KEY}
    extra_hosts:
      - "host.docker.internal:host-gateway"

volumes:
  lidify_data:
